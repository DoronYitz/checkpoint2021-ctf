# Memento

---

##### The message:

> My good friend Leonard created this game.
> Leonard told me he hid a flag inside, but doesnâ€™t remember exactly how.
> He also gave me the code of the server, so you can take a look.
> The flag is in the format CSA{...}
> The only possible characters inside {} are lowercase english letters and \_ (no numbers, no
> uppercase, no special characters).
> You have only 5 attempts for submitting the flag.

```
http://memento.csa-challenge.com:8888/
```

##### The assets:

server.py, which is the server source code for generating the boards.

##### Solution

Created 9 demo boards and checked there shortest path generate using Counter module.

```
demo1 - represents shortest path 1
demo2- represents shortest path 2
...
```

The server using /verifygame route to check validity of generated board.
There are connection between the flag and shortest path generated...

Shortest is generated by the server as the following:

```
# Random card number
    card_number = random.randint(1, 20)
    # Board decoded from base 64
    board_obj = json.loads(base64.b64decode(board))
    indexes = []
    for i in range(5):
        for j in range(8):
            # Depends on card number chose and if its available on the demo board
            if board_obj[i][j] == card_number:
                indexes.append([i, j])

    # Generate shortest using only 2 indexes
    shortest = shortest_path(indexes[0], indexes[1], board, "UP|DOWN|LEFT|RIGHT")
    shortest = shortest.length - 1
```

For each level use 15 attempts with each of demo boards created by us represents the shortest path from 1-9
Using result/attempts (statistics) to check which one is the right shortest path belongs to each level

```
Level 1 sample with 15 attempts:
0.0: Counter({1: 5, 9: 1})
0.0: Counter({2: 5, 10: 1})
0.26666666666666666: Counter({3: 5, 10: 1})
0.0: Counter({4: 5, 10: 1})
0.0: Counter({5: 5, 10: 1})
0.0: Counter({6: 5, 10: 1})
0.0: Counter({7: 5, 9: 1})
0.0: Counter({8: 6})
0.0: Counter({9: 4})

Which means level 1 - Shortest path #3


0.0: Counter({1: 5, 9: 1})
0.3333333333333333: Counter({2: 5, 10: 1})
0.0: Counter({3: 5, 10: 1})
0.0: Counter({4: 5, 10: 1})
0.0: Counter({5: 5, 10: 1})
0.0: Counter({6: 5, 10: 1})
0.0: Counter({7: 5, 9: 1})
0.0: Counter({8: 6})
0.0: Counter({9: 4})

Which means level 16 - Shortest path #2
```

Next we find out which asci chars and \_ represents each shortest path number from 1-9 using

```
result = 0
    if shortest == (flag[level] % 9) + 1:
        result = 1
    return result
```

Results:

```
["c","l","u"] #1
["d","m","v"] #2
["e","n","w"] #3
["f","o","x"] #4
["g","p","y"] #5
["_","h","q","z"] #6
["i","r"] #7
["a","j","s"] #8
["b","k","t"] #9
```

Next we got a kind of a puzzle -

```
lvl0=["g","p","y"]#5
lvl1=["e","n","w"]#3
lvl2=["e","n","w"]#3
lvl3=["i","r"]#7
lvl4=["e","n","w"]#3
lvl5=["e","n","w"]#3
lvl6=["_","h","q","z"]#6
lvl7=["a","j","s"]#8
lvl8=["c","l","u"]#1
lvl9=["c","l","u"] #1
lvl10=["_","h","q","z"]#6
lvl11=["e","n","w"]#3
lvl12=["e","n","w"]#3
lvl13=["e","n","w"]#3
lvl14=["d","m","v"]#2
lvl15=["_","h","q","z"]#6
lvl16=["d","m","v"]#2
lvl17=["i","r"]#7
lvl18=["i","r"]#7
lvl19=["i","r"]#7
lvl20=["f","o","x"]#4
lvl21=["i","r"]#7
lvl22=["a","j","s"]#8
lvl23=["b","k","t"]#9
lvl24=["d","m","v"]#2
```

##### Flag:

Flag is also a reference to the famous sentence from Memento movie

```
CSA{we_all_need_mirrors}
```
